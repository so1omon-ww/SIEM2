rules:
  - name: "ssh_connection"
    type: "immediate"
    description: "SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ"
    severity: "low"
    category: "network"
    tags: ["ssh", "network", "remote_access"]
    
    # –£—Å–ª–æ–≤–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è - SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
    matches:
      - field: "event_type"
        operator: "eq"
        value: "net.connection"
        case_sensitive: false
      
      - field: "dst_port"
        operator: "eq"
        value: 22
        case_sensitive: false
    
    # –î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏
    actions:
      - type: "alert"
        parameters:
          title: "üîê SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ"
          description: "–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å {src_ip} –Ω–∞ {dst_ip}:22"
        priority: 4
      
      - type: "log"
        parameters:
          message: "SSH connection detected from {src_ip} to {dst_ip}"
          level: "info"
        priority: 5

  - name: "ftp_connection"
    type: "immediate"
    description: "FTP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ"
    severity: "low"
    category: "network"
    tags: ["ftp", "network", "file_transfer"]
    
    # –£—Å–ª–æ–≤–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è - FTP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
    matches:
      - field: "event_type"
        operator: "eq"
        value: "net.connection"
        case_sensitive: false
      
      - field: "dst_port"
        operator: "in"
        value: [21, 20]
        case_sensitive: false
    
    # –î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏
    actions:
      - type: "alert"
        parameters:
          title: "üìÅ FTP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ"
          description: "–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ FTP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å {src_ip} –Ω–∞ {dst_ip}:{dst_port}"
        priority: 4
      
      - type: "log"
        parameters:
          message: "FTP connection detected from {src_ip} to {dst_ip}:{dst_port}"
          level: "info"
        priority: 5

  - name: "email_traffic"
    type: "immediate"
    description: "–ü–æ—á—Ç–æ–≤—ã–π —Ç—Ä–∞—Ñ–∏–∫"
    severity: "low"
    category: "network"
    tags: ["email", "network", "smtp", "imap", "pop3"]
    
    # –£—Å–ª–æ–≤–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è - –ø–æ—á—Ç–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã
    matches:
      - field: "event_type"
        operator: "eq"
        value: "net.connection"
        case_sensitive: false
      
      - field: "dst_port"
        operator: "in"
        value: [25, 110, 143, 465, 587, 993, 995]
        case_sensitive: false
    
    # –î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏
    actions:
      - type: "alert"
        parameters:
          title: "üìß –ü–æ—á—Ç–æ–≤—ã–π —Ç—Ä–∞—Ñ–∏–∫"
          description: "–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ—á—Ç–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ –ø–æ—Ä—Ç {dst_port}"
        priority: 4
      
      - type: "log"
        parameters:
          message: "Email traffic detected to port {dst_port}"
          level: "info"
        priority: 5

  - name: "high_traffic_volume"
    type: "immediate"
    description: "–í—ã—Å–æ–∫–∏–π –æ–±—ä–µ–º —Ç—Ä–∞—Ñ–∏–∫–∞"
    severity: "medium"
    category: "network"
    tags: ["traffic", "network", "volume"]
    
    # –£—Å–ª–æ–≤–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è - –±–æ–ª—å—à–æ–π –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö
    matches:
      - field: "event_type"
        operator: "eq"
        value: "net.connection"
        case_sensitive: false
      
      - field: "protocol"
        operator: "eq"
        value: "tcp"
        case_sensitive: false
    
    # –î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏
    actions:
      - type: "alert"
        parameters:
          title: "[STATS] –í—ã—Å–æ–∫–∏–π –æ–±—ä–µ–º —Ç—Ä–∞—Ñ–∏–∫–∞"
          description: "–û–±–Ω–∞—Ä—É–∂–µ–Ω TCP —Ç—Ä–∞—Ñ–∏–∫ –º–µ–∂–¥—É {src_ip} –∏ {dst_ip}"
        priority: 3
      
      - type: "log"
        parameters:
          message: "High volume TCP traffic detected"
          level: "warning"
        priority: 4

  - name: "database_connection"
    type: "immediate"
    description: "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"
    severity: "medium"
    category: "network"
    tags: ["database", "network", "mysql", "postgresql"]
    
    # –£—Å–ª–æ–≤–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
    matches:
      - field: "event_type"
        operator: "eq"
        value: "net.connection"
        case_sensitive: false
      
      - field: "dst_port"
        operator: "in"
        value: [3306, 5432, 1433, 1521, 27017]
        case_sensitive: false
    
    # –î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏
    actions:
      - type: "alert"
        parameters:
          title: "[DATABASE] –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î"
          description: "–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ø–æ—Ä—Ç {dst_port}"
        priority: 3
      
      - type: "log"
        parameters:
          message: "Database connection detected to port {dst_port}"
          level: "warning"
        priority: 4
